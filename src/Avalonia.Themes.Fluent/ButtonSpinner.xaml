<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=netstandard"
        xmlns:converters="clr-namespace:Avalonia.Controls.Converters;assembly=Avalonia.Controls">
  <Design.PreviewWith>
    <Border Padding="20"
            Background="Black">
      <StackPanel Spacing="20">
        <ButtonSpinner ButtonSpinnerLocation="Right"
                       Content="Right disabled inline spinner"
                       AllowSpin="False" />
        <ButtonSpinner ButtonSpinnerLocation="Left"
                       Content="Left spinner" />
        <ButtonSpinner ButtonSpinnerLocation="Right"
                       Classes="CompactInlineButtonSpinner"
                       Content="Right compact spinner" />
        <ButtonSpinner ButtonSpinnerLocation="Left"
                       Classes="CompactInlineButtonSpinner"
                       AllowSpin="False"
                       Content="Left disabled compact spinner" />
        <ButtonSpinner ShowButtonSpinner="False"
                       Content="Hide spinner" />
      </StackPanel>
    </Border>
  </Design.PreviewWith>

  <Styles.Resources>
    <converters:MarginMultiplierConverter x:Key="ButtonSpinner_OnlyLeftThinknessConverter"
                                          Indent="1"
                                          Left="True" />
    <converters:MarginMultiplierConverter x:Key="ButtonSpinner_OnlyRightThinknessConverter"
                                          Indent="1"
                                          Right="True" />

    <StreamGeometry x:Key="ButtonSpinnerIncreaseButtonIcon">M0,9 L10,0 20,9 19,10 10,2 1,10 z</StreamGeometry>
    <StreamGeometry x:Key="ButtonSpinnerDecreaseButtonIcon">M0,1 L10,10 20,1 19,0 10,8 1,0 z</StreamGeometry>
    <StreamGeometry x:Key="ButtonSpinnerIncreaseDecreaseButtonIcon">M0,9 L10,0 20,9 19,10 10,2 1,10 z M0,16 L10,25 20,16 19,15 10,23 1,15 z</StreamGeometry>
  </Styles.Resources>

  <!--  RepeatButton.ButtonSpinnerRepeatButton  -->
  <Style Selector="RepeatButton.ButtonSpinnerRepeatButton">
    <Setter Property="MinWidth" Value="34" />
    <Setter Property="VerticalAlignment" Value="Stretch" />
  </Style>

  <Style Selector="RepeatButton.ButtonSpinnerRepeatButton /template/ ContentPresenter">
    <Setter Property="BorderBrush" Value="{TemplateBinding BorderBrush}" />
  </Style>
  <Style Selector="RepeatButton.ButtonSpinnerRepeatButton:disabled">
    <Setter Property="BorderBrush" Value="{TemplateBinding BorderBrush}" />
  </Style>

  <!--  ButtonSpinner  -->
  <Style Selector="ButtonSpinner">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="Foreground" Value="{DynamicResource TextControlForeground}" />
    <Setter Property="Padding" Value="10, 0" />
    <Setter Property="Background" Value="{DynamicResource TextControlBackground}" />
    <Setter Property="BorderBrush" Value="{DynamicResource TextControlBorderBrush}" />
    <Setter Property="BorderThickness" Value="{DynamicResource TextControlBorderThemeThickness}" />
    <Setter Property="MinHeight" Value="{DynamicResource TextControlThemeMinHeight}" />
    <Setter Property="MinWidth" Value="{DynamicResource TextControlThemeMinWidth}" />
    <Setter Property="FontFamily" Value="{DynamicResource ContentControlThemeFontFamily}" />
    <Setter Property="FontSize" Value="{DynamicResource ControlContentThemeFontSize}" />
    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Template">
      <ControlTemplate>
        <Border Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="{DynamicResource ControlCornerRadius}">
          <Grid ColumnDefinitions="Auto,*,Auto">
            <ContentPresenter Name="PART_ContentPresenter"
                              Grid.Column="1"
                              ContentTemplate="{TemplateBinding ContentTemplate}"
                              Content="{TemplateBinding Content}"
                              HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                              Padding="{TemplateBinding Padding}" />

            <StackPanel Name="PART_SpinnerPanel"
                        Orientation="Horizontal"
                        IsVisible="{TemplateBinding ShowButtonSpinner}">
              <RepeatButton Name="PART_IncreaseButton"
                            Classes="ButtonSpinnerRepeatButton"
                            VerticalContentAlignment="Center"
                            Foreground="{TemplateBinding Foreground}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Background="{TemplateBinding Background}"
                            FontSize="{TemplateBinding FontSize}">
                <Path Fill="{TemplateBinding Foreground}"
                      Width="16"
                      Height="8"
                      Stretch="Uniform"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="{StaticResource ButtonSpinnerIncreaseButtonIcon}" />
              </RepeatButton>

              <RepeatButton Name="PART_DecreaseButton"
                            Classes="ButtonSpinnerRepeatButton"
                            Foreground="{TemplateBinding Foreground}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Background="{TemplateBinding Background}"
                            VerticalContentAlignment="Center"
                            FontSize="{TemplateBinding FontSize}">
                <Path Fill="{TemplateBinding Foreground}"
                      Width="16"
                      Height="8"
                      Stretch="Uniform"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="{StaticResource ButtonSpinnerDecreaseButtonIcon}" />
              </RepeatButton>
              <Border Name="PART_UpDownIconBorder"
                      MinWidth="34">
                <Path Name="PART_UpDownPathIcon"
                      Fill="{TemplateBinding Foreground}"
                      Height="12"
                      Stretch="Uniform"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="{StaticResource ButtonSpinnerIncreaseDecreaseButtonIcon}" />
              </Border>

              <Popup x:Name="UpDownPopup"
                     Grid.Row="1"
                     Grid.Column="1"
                     VerticalOffset="-20"
                     HorizontalOffset="-28"
                     PlacementMode="Right"
                     PlacementTarget="{TemplateBinding}"
                     HorizontalAlignment="Left">

                <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                        BorderBrush="{DynamicResource ToolTipBorderBrush}"
                        BorderThickness="{DynamicResource ToolTipBorderThemeThickness}"
                        CornerRadius="{DynamicResource OverlayCornerRadius}">
                  <Grid x:Name="PopupContentRoot"
                        RowDefinitions="*,*">
                    <RepeatButton x:Name="PopupUpSpinButton"
                                  Classes="ButtonSpinnerRepeatButton">
                      <Path Fill="{TemplateBinding Foreground}"
                            Width="16"
                            Height="8"
                            Stretch="Uniform"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Data="{StaticResource ButtonSpinnerDecreaseButtonIcon}" />
                    </RepeatButton>

                    <RepeatButton x:Name="PopupDownSpinButton"
                                  Grid.Row="1"
                                  Classes="ButtonSpinnerRepeatButton"
                                  Content="&#xE70D;" />
                  </Grid>
                </Border>
              </Popup>
            </StackPanel>
          </Grid>
        </Border>
      </ControlTemplate>
    </Setter>
  </Style>

  <!--  ButtonSpinnerLocation=Right  -->
  <Style Selector="ButtonSpinner:right /template/ StackPanel#PART_SpinnerPanel">
    <Setter Property="Grid.Column" Value="2" />
  </Style>
  <Style Selector="ButtonSpinner:right /template/ RepeatButton.ButtonSpinnerRepeatButton">
    <Setter Property="BorderThickness" Value="{Binding $parent[ButtonSpinner].BorderThickness, Converter={StaticResource ButtonSpinner_OnlyLeftThinknessConverter}}" />
  </Style>

  <!--  ButtonSpinnerLocation=Left  -->
  <Style Selector="ButtonSpinner:left /template/ StackPanel#PART_SpinnerPanel">
    <Setter Property="Grid.Column" Value="0" />
  </Style>
  <Style Selector="ButtonSpinner:left /template/ RepeatButton.ButtonSpinnerRepeatButton">
    <Setter Property="BorderThickness" Value="{Binding $parent[ButtonSpinner].BorderThickness, Converter={StaticResource ButtonSpinner_OnlyRightThinknessConverter}}" />
  </Style>

  <!--  Inline (default)  -->
  <Style Selector="ButtonSpinner:not(.CompactInlineButtonSpinner) /template/ Border#PART_UpDownIconBorder">
    <Setter Property="IsVisible" Value="False" />
  </Style>

  <!--  CompactInline  -->
  <Style Selector="ButtonSpinner.CompactInlineButtonSpinner /template/ RepeatButton.ButtonSpinnerRepeatButton">
    <Setter Property="IsVisible" Value="False" />
  </Style>

  <Style Selector="ButtonSpinner.CompactInlineButtonSpinner[AllowSpin=false] /template/ Path#PART_UpDownPathIcon">
    <Setter Property="Opacity" Value="0.5" />
  </Style>

  <Style Selector="ButtonSpinner.CompactInlineButtonSpinner:pointerover /template/ Popup#UpDownPopup">
    <Setter Property="IsOpen" Value="True" />
  </Style>

  <!--  Error state  -->
  <Style Selector="ButtonSpinner:error">
    <Setter Property="BorderBrush" Value="{DynamicResource ErrorBrush}" />
  </Style>

</Styles>
