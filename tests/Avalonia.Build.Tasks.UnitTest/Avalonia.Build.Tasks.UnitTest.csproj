<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>$(AvsCurrentTargetFramework);net481</TargetFrameworks>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <OutputType>Exe</OutputType>
    <IsPackable>false</IsPackable>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <Configuration Condition="'$(Configuration)'==''">Debug</Configuration>
  </PropertyGroup>

  <Import Project="..\..\build\Moq.props" />
  <Import Project="..\..\build\Rx.props" />
  <Import Project="..\..\build\HarfBuzzSharp.props" />
  <Import Project="..\..\build\XUnit.props" />
  <Import Project="..\..\build\SharedVersion.props" />
  <Import Project="..\..\build\NullableEnable.props" />
  <ItemGroup>
    <Content Include="..\TestFiles\BuildTasks\PInvoke\bin\$(Configuration)\$(AvsCurrentTargetFramework)\PInvoke.dll" Link="Assets\PInvoke.dll">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="..\TestFiles\BuildTasks\PInvoke\bin\$(Configuration)\$(AvsCurrentTargetFramework)\PInvoke.dll.refs" Link="Assets\PInvoke.dll.refs">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.Build.Framework" Version="15.1.548" PrivateAssets="All" />
    <PackageReference Include="Microsoft.Build.Utilities.Core" Version="15.1.548" />
  </ItemGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\src\Avalonia.Build.Tasks\Avalonia.Build.Tasks.csproj" />
    <!-- Ensure PInvoke.csproj is build before Avalonia.Build.Tasks.UnitTest -->
    <ProjectReference Include="..\TestFiles\BuildTasks\PInvoke\PInvoke.csproj" 
                      SetConfiguration="Configuration=$(Configuration)"
                      SetTargetFramework="TargetFramework=$(AvsCurrentTargetFramework)"
                      ReferenceOutputAssembly="false" 
                      PrivateAssets="all" />
  </ItemGroup>
</Project>
